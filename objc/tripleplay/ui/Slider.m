//
//  Generated by the J2ObjC translator.  DO NOT EDIT!
//  source: tripleplay/ui/Slider.java
//
//  Created by Thomas on 7/1/13.
//

#import "Background.h"
#import "Canvas.h"
#import "CanvasImage.h"
#import "Connection.h"
#import "Dimension.h"
#import "Element.h"
#import "Graphics.h"
#import "GroupLayer.h"
#import "IOSClass.h"
#import "IPoint.h"
#import "Image.h"
#import "ImageLayer.h"
#import "Layer.h"
#import "PlayN.h"
#import "Pointer.h"
#import "Signal.h"
#import "SignalView.h"
#import "Style.h"
#import "UnitSlot.h"
#import "Value.h"
#import "Widget.h"
#import "java/lang/Float.h"
#import "java/lang/IllegalArgumentException.h"
#import "java/lang/Math.h"

@implementation TripleplayUiSlider

static TripleplayUiStyle * TripleplayUiSlider_BAR_WIDTH_;
static TripleplayUiStyle * TripleplayUiSlider_BAR_HEIGHT_;
static TripleplayUiStyle * TripleplayUiSlider_BAR_BACKGROUND_;
static TripleplayUiStyle * TripleplayUiSlider_THUMB_IMAGE_;
static TripleplayUiStyle * TripleplayUiSlider_THUMB_ORIGIN_;

- (ReactValue *)value {
  return value_;
}
- (void)setValue:(ReactValue *)value {
  JreOperatorRetainedAssign(&value_, self, value);
}
@synthesize value = value_;
- (ReactValue *)range {
  return range_;
}
- (void)setRange:(ReactValue *)range {
  JreOperatorRetainedAssign(&range_, self, range);
}
@synthesize range = range_;
- (ReactSignal *)_clicked {
  return _clicked_;
}
- (void)set_clicked:(ReactSignal *)_clicked {
  JreOperatorRetainedAssign(&_clicked_, self, _clicked);
}
@synthesize _clicked = _clicked_;
- (id<PlaynCoreImageLayer>)_thumb {
  return _thumb_;
}
- (void)set_thumb:(id<PlaynCoreImageLayer>)_thumb {
  JreOperatorRetainedAssign(&_thumb_, self, _thumb);
}
@synthesize _thumb = _thumb_;
- (TripleplayUiBackground_Instance *)_barInst {
  return _barInst_;
}
- (void)set_barInst:(TripleplayUiBackground_Instance *)_barInst {
  JreOperatorRetainedAssign(&_barInst_, self, _barInst);
}
@synthesize _barInst = _barInst_;
@synthesize _thumbLeft = _thumbLeft_;
@synthesize _thumbRange = _thumbRange_;
@synthesize _thumbY = _thumbY_;
- (JavaLangFloat *)_increment {
  return _increment_;
}
- (void)set_increment:(JavaLangFloat *)_increment {
  JreOperatorRetainedAssign(&_increment_, self, _increment);
}
@synthesize _increment = _increment_;

+ (TripleplayUiStyle *)BAR_WIDTH {
  return TripleplayUiSlider_BAR_WIDTH_;
}

+ (void)setBAR_WIDTH:(TripleplayUiStyle *)BAR_WIDTH {
  JreOperatorRetainedAssign(&TripleplayUiSlider_BAR_WIDTH_, self, BAR_WIDTH);
}

+ (TripleplayUiStyle *)BAR_HEIGHT {
  return TripleplayUiSlider_BAR_HEIGHT_;
}

+ (void)setBAR_HEIGHT:(TripleplayUiStyle *)BAR_HEIGHT {
  JreOperatorRetainedAssign(&TripleplayUiSlider_BAR_HEIGHT_, self, BAR_HEIGHT);
}

+ (TripleplayUiStyle *)BAR_BACKGROUND {
  return TripleplayUiSlider_BAR_BACKGROUND_;
}

+ (void)setBAR_BACKGROUND:(TripleplayUiStyle *)BAR_BACKGROUND {
  JreOperatorRetainedAssign(&TripleplayUiSlider_BAR_BACKGROUND_, self, BAR_BACKGROUND);
}

+ (TripleplayUiStyle *)THUMB_IMAGE {
  return TripleplayUiSlider_THUMB_IMAGE_;
}

+ (void)setTHUMB_IMAGE:(TripleplayUiStyle *)THUMB_IMAGE {
  JreOperatorRetainedAssign(&TripleplayUiSlider_THUMB_IMAGE_, self, THUMB_IMAGE);
}

+ (TripleplayUiStyle *)THUMB_ORIGIN {
  return TripleplayUiSlider_THUMB_ORIGIN_;
}

+ (void)setTHUMB_ORIGIN:(TripleplayUiStyle *)THUMB_ORIGIN {
  JreOperatorRetainedAssign(&TripleplayUiSlider_THUMB_ORIGIN_, self, THUMB_ORIGIN);
}

- (id)init {
  return [self initTripleplayUiSliderWithFloat:0 withFloat:0 withFloat:0];
}

- (id)initTripleplayUiSliderWithFloat:(float)value
                            withFloat:(float)min
                            withFloat:(float)max {
  if ((self = [super init])) {
    JreOperatorRetainedAssign(&_clicked_, self, ((ReactSignal *) [ReactSignal create]));
    [self enableInteraction];
    self.value = ((ReactValue *) [ReactValue createWithId:[JavaLangFloat valueOfWithFloat:value]]);
    JreOperatorRetainedAssign(&range_, self, ((ReactValue *) [ReactValue createWithId:[[[TripleplayUiSlider_Range alloc] initWithFloat:min withFloat:max] autorelease]]));
    [((id<PlaynCoreGroupLayer>) NIL_CHK(layer_)) addWithPlaynCoreLayer:JreOperatorRetainedAssign(&_thumb_, self, [((id<PlaynCoreGraphics>) [PlaynCorePlayN graphics]) createImageLayer])];
    (void) [((id<PlaynCoreImageLayer>) NIL_CHK(_thumb_)) setDepthWithFloat:1];
    ReactUnitSlot *updateThumb = [[[TripleplayUiSlider_$1 alloc] initWithTripleplayUiSlider:self] autorelease];
    (void) [((ReactValue *) NIL_CHK(self.value)) connectWithReactValueView_Listener:updateThumb];
    (void) [((ReactValue *) NIL_CHK(range_)) connectWithReactValueView_Listener:updateThumb];
  }
  return self;
}

- (id)initWithFloat:(float)value
          withFloat:(float)min
          withFloat:(float)max {
  return [self initTripleplayUiSliderWithFloat:value withFloat:min withFloat:max];
}

- (TripleplayUiSlider *)setIncrementWithFloat:(float)increment {
  JreOperatorRetainedAssign(&_increment_, self, [JavaLangFloat valueOfWithFloat:increment]);
  return self;
}

- (JavaLangFloat *)increment {
  return _increment_;
}

- (id<ReactSignalView>)clicked {
  return _clicked_;
}

- (float)max {
  return ((TripleplayUiSlider_Range *) [((ReactValue *) NIL_CHK(range_)) get]).max;
}

- (float)min {
  return ((TripleplayUiSlider_Range *) [((ReactValue *) NIL_CHK(range_)) get]).min;
}

- (IOSClass *)getStyleClass {
  return [IOSClass classWithClass:[TripleplayUiSlider class]];
}

- (void)wasRemoved {
  [super wasRemoved];
  if (_barInst_ != nil) {
    [_barInst_ destroy];
    JreOperatorRetainedAssign(&_barInst_, self, nil);
  }
}

- (TripleplayUiElement_LayoutData *)createLayoutDataWithFloat:(float)hintX
                                                    withFloat:(float)hintY {
  return [[[TripleplayUiSlider_SliderLayoutData alloc] initWithTripleplayUiSlider:self] autorelease];
}

- (void)onPointerStartWithPlaynCorePointer_Event:(id<PlaynCorePointer_Event>)event
                                       withFloat:(float)x
                                       withFloat:(float)y {
  [super onPointerStartWithPlaynCorePointer_Event:event withFloat:x withFloat:y];
  [self handlePointerWithFloat:x withFloat:y];
}

- (void)onPointerDragWithPlaynCorePointer_Event:(id<PlaynCorePointer_Event>)event
                                      withFloat:(float)x
                                      withFloat:(float)y {
  [super onPointerDragWithPlaynCorePointer_Event:event withFloat:x withFloat:y];
  [self handlePointerWithFloat:x withFloat:y];
}

- (void)onPointerEndWithPlaynCorePointer_Event:(id<PlaynCorePointer_Event>)event
                                     withFloat:(float)x
                                     withFloat:(float)y {
  [super onPointerEndWithPlaynCorePointer_Event:event withFloat:x withFloat:y];
  [self handlePointerWithFloat:x withFloat:y];
  [((ReactSignal *) NIL_CHK(_clicked_)) emitWithId:self];
}

- (void)updateThumb {
  TripleplayUiSlider_Range *r = ((TripleplayUiSlider_Range *) [((ReactValue *) NIL_CHK(range_)) get]);
  float thumbPct = ([((JavaLangFloat *) [((ReactValue *) NIL_CHK(value_)) get]) floatValue] - ((TripleplayUiSlider_Range *) NIL_CHK(r)).min) / ((TripleplayUiSlider_Range *) NIL_CHK(r)).range;
  (void) [((id<PlaynCoreImageLayer>) NIL_CHK(_thumb_)) setTranslationWithFloat:_thumbLeft_ + _thumbRange_ * thumbPct withFloat:_thumbY_];
}

- (void)handlePointerWithFloat:(float)x
                     withFloat:(float)y {
  TripleplayUiSlider_Range *r = ((TripleplayUiSlider_Range *) [((ReactValue *) NIL_CHK(range_)) get]);
  float width = _thumbRange_;
  x = [JavaLangMath minWithFloat:width withFloat:x - _thumbLeft_];
  float pos = [JavaLangMath maxWithFloat:x withFloat:0] / width * ((TripleplayUiSlider_Range *) NIL_CHK(r)).range;
  if (_increment_ != nil) {
    float i = [_increment_ floatValue];
    pos = i * [JavaLangMath roundWithFloat:pos / i];
  }
  (void) [((ReactValue *) NIL_CHK(value_)) updateWithId:[JavaLangFloat valueOfWithFloat:((TripleplayUiSlider_Range *) NIL_CHK(r)).min + pos]];
}

+ (id<PlaynCoreImage>)createDefaultThumbImage {
  float size = 24;
  id<PlaynCoreCanvasImage> image = [((id<PlaynCoreGraphics>) [PlaynCorePlayN graphics]) createImageWithFloat:size withFloat:size];
  (void) [((id<PlaynCoreCanvas>) [((id<PlaynCoreCanvasImage>) NIL_CHK(image)) canvas]) setFillColorWithInt:(int) 0xFF000000];
  (void) [((id<PlaynCoreCanvas>) [((id<PlaynCoreCanvasImage>) NIL_CHK(image)) canvas]) fillCircleWithFloat:size / 2 withFloat:size / 2 withFloat:size / 2 - 1];
  return image;
}

+ (void)initialize {
  if (self == [TripleplayUiSlider class]) {
    JreOperatorRetainedAssign(&TripleplayUiSlider_BAR_WIDTH_, self, ((TripleplayUiStyle *) [TripleplayUiStyle newStyleWithBOOL:YES withId:[JavaLangFloat valueOfWithFloat:100.0f]]));
    JreOperatorRetainedAssign(&TripleplayUiSlider_BAR_HEIGHT_, self, ((TripleplayUiStyle *) [TripleplayUiStyle newStyleWithBOOL:YES withId:[JavaLangFloat valueOfWithFloat:5.0f]]));
    JreOperatorRetainedAssign(&TripleplayUiSlider_BAR_BACKGROUND_, self, ((TripleplayUiStyle *) [TripleplayUiStyle newStyleWithBOOL:YES withId:[TripleplayUiBackground solidWithInt:(int) 0xFF000000]]));
    JreOperatorRetainedAssign(&TripleplayUiSlider_THUMB_IMAGE_, self, ((TripleplayUiStyle *) [TripleplayUiStyle newStyleWithBOOL:YES withId:[TripleplayUiSlider createDefaultThumbImage]]));
    JreOperatorRetainedAssign(&TripleplayUiSlider_THUMB_ORIGIN_, self, ((TripleplayUiStyle *) [TripleplayUiStyle newStyleWithBOOL:NO withId:(id<PythagorasFIPoint>) nil]));
  }
}

- (void)dealloc {
  JreOperatorRetainedAssign(&_increment_, self, nil);
  JreOperatorRetainedAssign(&_barInst_, self, nil);
  JreOperatorRetainedAssign(&_thumb_, self, nil);
  JreOperatorRetainedAssign(&_clicked_, self, nil);
  JreOperatorRetainedAssign(&range_, self, nil);
  JreOperatorRetainedAssign(&value_, self, nil);
  [super dealloc];
}

- (void)copyAllPropertiesTo:(id)copy {
  [super copyAllPropertiesTo:copy];
  TripleplayUiSlider *typedCopy = (TripleplayUiSlider *) copy;
  typedCopy.value = value_;
  typedCopy.range = range_;
  typedCopy._clicked = _clicked_;
  typedCopy._thumb = _thumb_;
  typedCopy._barInst = _barInst_;
  typedCopy._thumbLeft = _thumbLeft_;
  typedCopy._thumbRange = _thumbRange_;
  typedCopy._thumbY = _thumbY_;
  typedCopy._increment = _increment_;
}

@end
@implementation TripleplayUiSlider_Range

@synthesize min = min_;
@synthesize max = max_;
@synthesize range = range_;

- (id)initWithFloat:(float)min
          withFloat:(float)max {
  if ((self = [super init])) {
    if (min > max) @throw [[[JavaLangIllegalArgumentException alloc] init] autorelease];
    self.min = min;
    self.max = max;
    self.range = max - min;
  }
  return self;
}

- (void)dealloc {
  [super dealloc];
}

- (void)copyAllPropertiesTo:(id)copy {
  [super copyAllPropertiesTo:copy];
  TripleplayUiSlider_Range *typedCopy = (TripleplayUiSlider_Range *) copy;
  typedCopy.min = min_;
  typedCopy.max = max_;
  typedCopy.range = range_;
}

@end
@implementation TripleplayUiSlider_SliderLayoutData

- (TripleplayUiSlider *)this$2 {
  return this$2_;
}
- (void)setThis$2:(TripleplayUiSlider *)this$2 {
  JreOperatorRetainedAssign(&this$2_, self, this$2);
}
@synthesize this$2 = this$2_;
@synthesize barWidth = barWidth_;
@synthesize barHeight = barHeight_;
- (TripleplayUiBackground *)barBG {
  return barBG_;
}
- (void)setBarBG:(TripleplayUiBackground *)barBG {
  JreOperatorRetainedAssign(&barBG_, self, barBG);
}
@synthesize barBG = barBG_;
- (id<PlaynCoreImage>)thumbImage {
  return thumbImage_;
}
- (void)setThumbImage:(id<PlaynCoreImage>)thumbImage {
  JreOperatorRetainedAssign(&thumbImage_, self, thumbImage);
}
@synthesize thumbImage = thumbImage_;
- (id<PythagorasFIPoint>)thumbOrigin {
  return thumbOrigin_;
}
- (void)setThumbOrigin:(id<PythagorasFIPoint>)thumbOrigin {
  JreOperatorRetainedAssign(&thumbOrigin_, self, thumbOrigin);
}
@synthesize thumbOrigin = thumbOrigin_;

- (PythagorasFDimension *)computeSizeWithFloat:(float)hintX
                                     withFloat:(float)hintY {
  return [[[PythagorasFDimension alloc] initWithFloat:barWidth_ + [((id<PlaynCoreImage>) NIL_CHK(thumbImage_)) width] withFloat:[JavaLangMath maxWithFloat:barHeight_ withFloat:[((id<PlaynCoreImage>) NIL_CHK(thumbImage_)) height]]] autorelease];
}

- (void)layoutWithFloat:(float)left
              withFloat:(float)top
              withFloat:(float)width
              withFloat:(float)height {
  float thumbWidth = [((id<PlaynCoreImage>) NIL_CHK(thumbImage_)) width], thumbHeight = [((id<PlaynCoreImage>) NIL_CHK(thumbImage_)) height];
  this$2_._thumbRange = width - thumbWidth;
  this$2_._thumbLeft = left + thumbWidth / 2;
  this$2_._thumbY = top + height / 2;
  (void) [((id<PlaynCoreImageLayer>) NIL_CHK(this$2_._thumb)) setImageWithPlaynCoreImage:thumbImage_];
  if (thumbOrigin_ == nil) {
    (void) [((id<PlaynCoreImageLayer>) NIL_CHK(this$2_._thumb)) setOriginWithFloat:thumbWidth / 2 withFloat:thumbHeight / 2];
  }
  else {
    (void) [((id<PlaynCoreImageLayer>) NIL_CHK(this$2_._thumb)) setOriginWithFloat:[thumbOrigin_ x] withFloat:[thumbOrigin_ y]];
  }
  if (this$2_._barInst != nil) [this$2_._barInst destroy];
  if (width > 0 && height > 0) {
    this$2_._barInst = [((TripleplayUiBackground *) NIL_CHK(barBG_)) instantiateWithPythagorasFIDimension:[[[PythagorasFDimension alloc] initWithFloat:width - thumbWidth withFloat:barHeight_] autorelease]];
    [((TripleplayUiBackground_Instance *) NIL_CHK(this$2_._barInst)) addToWithPlaynCoreGroupLayer:this$2_.layer withFloat:this$2_._thumbLeft withFloat:top + (height - barHeight_) / 2 withFloat:1];
  }
  [this$2_ updateThumb];
}

- (id)initWithTripleplayUiSlider:(TripleplayUiSlider *)outer$ {
  if ((self = [super initWithTripleplayUiElement:outer$])) {
    JreOperatorRetainedAssign(&this$2_, self, outer$);
    barWidth_ = [((JavaLangFloat *) [outer$ resolveStyleWithTripleplayUiStyle:[TripleplayUiSlider BAR_WIDTH]]) floatValue];
    barHeight_ = [((JavaLangFloat *) [outer$ resolveStyleWithTripleplayUiStyle:[TripleplayUiSlider BAR_HEIGHT]]) floatValue];
    JreOperatorRetainedAssign(&barBG_, self, ((TripleplayUiBackground *) [outer$ resolveStyleWithTripleplayUiStyle:[TripleplayUiSlider BAR_BACKGROUND]]));
    JreOperatorRetainedAssign(&thumbImage_, self, ((id<PlaynCoreImage>) [outer$ resolveStyleWithTripleplayUiStyle:[TripleplayUiSlider THUMB_IMAGE]]));
    JreOperatorRetainedAssign(&thumbOrigin_, self, ((id<PythagorasFIPoint>) [outer$ resolveStyleWithTripleplayUiStyle:[TripleplayUiSlider THUMB_ORIGIN]]));
  }
  return self;
}

- (void)dealloc {
  JreOperatorRetainedAssign(&thumbOrigin_, self, nil);
  JreOperatorRetainedAssign(&thumbImage_, self, nil);
  JreOperatorRetainedAssign(&barBG_, self, nil);
  JreOperatorRetainedAssign(&this$2_, self, nil);
  [super dealloc];
}

- (void)copyAllPropertiesTo:(id)copy {
  [super copyAllPropertiesTo:copy];
  TripleplayUiSlider_SliderLayoutData *typedCopy = (TripleplayUiSlider_SliderLayoutData *) copy;
  typedCopy.this$2 = this$2_;
  typedCopy.barWidth = barWidth_;
  typedCopy.barHeight = barHeight_;
  typedCopy.barBG = barBG_;
  typedCopy.thumbImage = thumbImage_;
  typedCopy.thumbOrigin = thumbOrigin_;
}

@end
@implementation TripleplayUiSlider_$1

- (TripleplayUiSlider *)this$0 {
  return this$0_;
}
- (void)setThis$0:(TripleplayUiSlider *)this$0 {
  JreOperatorRetainedAssign(&this$0_, self, this$0);
}
@synthesize this$0 = this$0_;

- (void)onEmit {
  [this$0_ updateThumb];
}

- (id)initWithTripleplayUiSlider:(TripleplayUiSlider *)outer$ {
  if ((self = [super init])) {
    JreOperatorRetainedAssign(&this$0_, self, outer$);
  }
  return self;
}

- (void)dealloc {
  JreOperatorRetainedAssign(&this$0_, self, nil);
  [super dealloc];
}

- (void)copyAllPropertiesTo:(id)copy {
  [super copyAllPropertiesTo:copy];
  TripleplayUiSlider_$1 *typedCopy = (TripleplayUiSlider_$1 *) copy;
  typedCopy.this$0 = this$0_;
}

@end
