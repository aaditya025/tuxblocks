//
//  Generated by the J2ObjC translator.  DO NOT EDIT!
//  source: tripleplay/util/Glyph.java
//
//  Created by Thomas on 7/1/13.
//

#import "Canvas.h"
#import "CanvasImage.h"
#import "EffectRenderer.h"
#import "Graphics.h"
#import "GroupLayer.h"
#import "IDimension.h"
#import "IOSClass.h"
#import "ImageLayer.h"
#import "Layer.h"
#import "PlayN.h"
#import "Ref.h"
#import "TextConfig.h"
#import "TextLayout.h"
#import "java/lang/Float.h"

@implementation TripleplayUtilGlyph

- (id<PlaynCoreGroupLayer>)_parent {
  return _parent_;
}
- (void)set_parent:(id<PlaynCoreGroupLayer>)_parent {
  JreOperatorRetainedAssign(&_parent_, self, _parent);
}
@synthesize _parent = _parent_;
- (JavaLangFloat *)_depth {
  return _depth_;
}
- (void)set_depth:(JavaLangFloat *)_depth {
  JreOperatorRetainedAssign(&_depth_, self, _depth);
}
@synthesize _depth = _depth_;
- (id<PlaynCoreCanvasImage>)_image {
  return _image_;
}
- (void)set_image:(id<PlaynCoreCanvasImage>)_image {
  JreOperatorRetainedAssign(&_image_, self, _image);
}
@synthesize _image = _image_;
- (TripleplayUtilRef *)_layer {
  return _layer_;
}
- (void)set_layer:(TripleplayUtilRef *)_layer {
  JreOperatorRetainedAssign(&_layer_, self, _layer);
}
@synthesize _layer = _layer_;
@synthesize _preparedWidth = _preparedWidth_;
@synthesize _preparedHeight = _preparedHeight_;

- (id)initWithPlaynCoreGroupLayer:(id<PlaynCoreGroupLayer>)parent {
  if ((self = [super init])) {
    JreOperatorRetainedAssign(&_layer_, self, ((TripleplayUtilRef *) [TripleplayUtilRef createWithId:nil]));
    JreOperatorRetainedAssign(&_parent_, self, parent);
    JreOperatorRetainedAssign(&_depth_, self, nil);
  }
  return self;
}

- (id)initWithPlaynCoreGroupLayer:(id<PlaynCoreGroupLayer>)parent
                        withFloat:(float)depth {
  if ((self = [super init])) {
    JreOperatorRetainedAssign(&_layer_, self, ((TripleplayUtilRef *) [TripleplayUtilRef createWithId:nil]));
    JreOperatorRetainedAssign(&_parent_, self, parent);
    JreOperatorRetainedAssign(&_depth_, self, [JavaLangFloat valueOfWithFloat:depth]);
  }
  return self;
}

- (void)prepareWithPythagorasFIDimension:(id<PythagorasFIDimension>)dim {
  [self prepareWithFloat:[((id<PythagorasFIDimension>) NIL_CHK(dim)) width] withFloat:[((id<PythagorasFIDimension>) NIL_CHK(dim)) height]];
}

- (void)prepareWithFloat:(float)width
               withFloat:(float)height {
  id<PlaynCoreImageLayer> layer = ((id<PlaynCoreImageLayer>) [((TripleplayUtilRef *) NIL_CHK(_layer_)) get]);
  if (_image_ == nil || [((id<PlaynCoreCanvasImage>) NIL_CHK(_image_)) width] < width || [((id<PlaynCoreCanvasImage>) NIL_CHK(_image_)) height] < height) {
    JreOperatorRetainedAssign(&_image_, self, [((id<PlaynCoreGraphics>) [PlaynCorePlayN graphics]) createImageWithFloat:width withFloat:height]);
    if (layer != nil) (void) [layer setImageWithPlaynCoreImage:_image_];
  }
  else {
    (void) [((id<PlaynCoreCanvas>) [((id<PlaynCoreCanvasImage>) NIL_CHK(_image_)) canvas]) clear];
  }
  if (layer == nil) {
    layer = ((id<PlaynCoreImageLayer>) [((TripleplayUtilRef *) NIL_CHK(_layer_)) setWithId:[((id<PlaynCoreGraphics>) [PlaynCorePlayN graphics]) createImageLayerWithPlaynCoreImage:_image_]]);
    if (_depth_ != nil) (void) [((id<PlaynCoreImageLayer>) NIL_CHK(layer)) setDepthWithFloat:[_depth_ floatValue]];
    [((id<PlaynCoreGroupLayer>) NIL_CHK(_parent_)) addWithPlaynCoreLayer:layer];
  }
  _preparedWidth_ = width;
  _preparedHeight_ = height;
}

- (id<PlaynCoreImageLayer>)layer {
  return ((id<PlaynCoreImageLayer>) [((TripleplayUtilRef *) NIL_CHK(_layer_)) get]);
}

- (id<PlaynCoreCanvas>)canvas {
  return [((id<PlaynCoreCanvasImage>) NIL_CHK(_image_)) canvas];
}

- (void)destroy {
  [((TripleplayUtilRef *) NIL_CHK(_layer_)) clear];
  JreOperatorRetainedAssign(&_image_, self, nil);
}

- (float)preparedWidth {
  return _preparedWidth_;
}

- (float)preparedHeight {
  return _preparedHeight_;
}

- (void)renderTextWithTripleplayUtilTextConfig:(TripleplayUtilTextConfig *)config
                                  withNSString:(NSString *)text {
  [self renderTextWithTripleplayUtilTextConfig:config withPlaynCoreTextLayout:[((TripleplayUtilTextConfig *) NIL_CHK(config)) layoutWithNSString:text]];
}

- (void)renderTextWithTripleplayUtilTextConfig:(TripleplayUtilTextConfig *)config
                       withPlaynCoreTextLayout:(id<PlaynCoreTextLayout>)layout {
  [self prepareWithFloat:[((TripleplayUtilEffectRenderer *) NIL_CHK(config.effect)) adjustWidthWithFloat:[((id<PlaynCoreTextLayout>) NIL_CHK(layout)) width]] withFloat:[((TripleplayUtilEffectRenderer *) NIL_CHK(config.effect)) adjustHeightWithFloat:[((id<PlaynCoreTextLayout>) NIL_CHK(layout)) height]]];
  [((TripleplayUtilTextConfig *) NIL_CHK(config)) renderWithPlaynCoreCanvas:[self canvas] withPlaynCoreTextLayout:layout withFloat:0 withFloat:0];
}

- (void)dealloc {
  JreOperatorRetainedAssign(&_layer_, self, nil);
  JreOperatorRetainedAssign(&_image_, self, nil);
  JreOperatorRetainedAssign(&_depth_, self, nil);
  JreOperatorRetainedAssign(&_parent_, self, nil);
  [super dealloc];
}

- (void)copyAllPropertiesTo:(id)copy {
  [super copyAllPropertiesTo:copy];
  TripleplayUtilGlyph *typedCopy = (TripleplayUtilGlyph *) copy;
  typedCopy._parent = _parent_;
  typedCopy._depth = _depth_;
  typedCopy._image = _image_;
  typedCopy._layer = _layer_;
  typedCopy._preparedWidth = _preparedWidth_;
  typedCopy._preparedHeight = _preparedHeight_;
}

@end
